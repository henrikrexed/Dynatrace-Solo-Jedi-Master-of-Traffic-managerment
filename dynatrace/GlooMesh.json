{"version":11,"variables":[],"tiles":{"0":{"type":"data","title":"Number of Request timeout Per Workload","query":"fetch logs //, scanLimitGBytes: 500, samplingRatio: 1000\n| filter matchesValue(k8s.namespace.name, \"hipster-shop\") \n| filter contains(content,\"ACCES\")\n| parse content ,\"LD:intro DQS:downstream LD SPACE DQS:dowstrealtls SPACE DQS LD SPACE DQS:method SPACE DQS LD SPACE DQS:path SPACE DQS LD SPACE DQS:protocol SPACE DQS LD SPACE DQS:Connection SPACE DQS LD SPACE DQS:response_code SPACE DQS LD SPACE DQS:response_flags SPACE DQS LD SPACE DQS:response_code_detaiuls SPACE DQS LD SPACE DQS:traceid SPACE DQS LD SPACE DQS:upstream_service_time SPACE DQS LD SPACE DQS:upstream_local_adress SPACE DQS LD SPACE DQS:duration SPACE DQS LD SPACE DQS:upstreamfailurereason SPACE DQS LD SPACE DQS:routename SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:useragent SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:request_servername SPACE DQS LD SPACE DQS:bytereceived SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:bytesent SPACE DQS LD SPACE DQS:upstreamcluster SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:authority LD \"\n| filter response_code_detaiuls ==\"max_duration_timeout\"\n| summarize count() , by: {bin(timestamp, 30s),k8s.deployment.name}","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"categoryOverrides":{}},"singleValue":{"label":"","prefixIcon":"","autoscale":true,"alignment":"center"},"table":{"rowDensity":"condensed","enableLineWrap":true,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}}}},"1":{"type":"data","title":"number of request rate limited per workload","query":"fetch logs //, scanLimitGBytes: 500, samplingRatio: 1000\n| filter matchesValue(k8s.namespace.name, \"hipster-shop\") \n| filter contains(content,\"ACCES\")\n| parse content ,\"LD:intro DQS:downstream LD SPACE DQS:dowstrealtls SPACE DQS LD SPACE DQS:method SPACE DQS LD SPACE DQS:path SPACE DQS LD SPACE DQS:protocol SPACE DQS LD SPACE DQS:Connection SPACE DQS LD SPACE DQS:response_code SPACE DQS LD SPACE DQS:response_flags SPACE DQS LD SPACE DQS:response_code_detaiuls SPACE DQS LD SPACE DQS:traceid SPACE DQS LD SPACE DQS:upstream_service_time SPACE DQS LD SPACE DQS:upstream_local_adress SPACE DQS LD SPACE DQS:duration SPACE DQS LD SPACE DQS:upstreamfailurereason SPACE DQS LD SPACE DQS:routename SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:useragent SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:request_servername SPACE DQS LD SPACE DQS:bytereceived SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:bytesent SPACE DQS LD SPACE DQS:upstreamcluster SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:authority LD \"\n| filter response_code_detaiuls == \"request_rate_limited\"\n| summarize count() , by: {bin(timestamp, 30s),k8s.deployment.name}","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"categoryOverrides":{}},"singleValue":{"label":"","prefixIcon":"","autoscale":true,"alignment":"center"},"table":{"rowDensity":"condensed","enableLineWrap":true,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}}}},"2":{"type":"data","title":"inbound latency of the envoy proxy per workload and Authorithy","query":"fetch logs //, scanLimitGBytes: 500, samplingRatio: 1000\n| filter matchesValue(k8s.namespace.name, \"hipster-shop\") \n| filter contains(content,\"ACCES\")\n| parse content ,\"LD:intro DQS:downstream LD SPACE DQS:dowstrealtls SPACE DQS LD SPACE DQS:method SPACE DQS LD SPACE DQS:path SPACE DQS LD SPACE DQS:protocol SPACE DQS LD SPACE DQS:Connection SPACE DQS LD SPACE DQS:response_code SPACE DQS LD SPACE DQS:response_flags SPACE DQS LD SPACE DQS:response_code_detaiuls SPACE DQS LD SPACE DQS:traceid SPACE DQS LD SPACE DQS:upstream_service_time SPACE DQS LD SPACE DQS:upstream_local_adress SPACE DQS LD SPACE DQS:duration SPACE DQS LD SPACE DQS:upstreamfailurereason SPACE DQS LD SPACE DQS:routename SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:useragent SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:request_servername SPACE DQS LD SPACE DQS:bytereceived SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:bytesent SPACE DQS LD SPACE DQS:upstreamcluster SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:authority LD \"\n| filter response_code_detaiuls ==\"via_upstream\"\n| filter contains(upstreamcluster,\"inbound\")\n| summarize avg(toDuration(duration)), by:{bin(timestamp, 30s),k8s.deployment.name, authority}","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"categoryOverrides":{}},"singleValue":{"label":"","prefixIcon":"","autoscale":true,"alignment":"center"},"table":{"rowDensity":"condensed","enableLineWrap":true,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}}}},"4":{"type":"data","title":"Envoy Proxy cpu % usage ( vs limit)","query":"timeseries avg(dt.containers.cpu.usage_percent), alias: average, by:{Container,dt.entity.container_group_instance}, filter:{matchesValue(Container,\"istio-proxy\")}\n| lookup [fetch dt.entity.container_group_instance ] , sourceField:dt.entity.container_group_instance,lookupField:id\n| fieldsRemove dt.entity.container_group_instance\n| fieldsAdd lookup.entity.name\n| summarize avg(average[]), by:{lookup.entity.name, timeframe, interval}","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"categoryOverrides":{}},"singleValue":{"label":"","prefixIcon":"","autoscale":true,"alignment":"center"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"columnWidths":{}},"unitsOverrides":[{"identifier":"dt.containers.cpu.usage_percent","unitCategory":"percentage","baseUnit":"percent","displayUnit":null,"decimals":2,"suffix":"","delimiter":true}]}},"5":{"type":"data","title":"outbound latency of the envoy proxy per workload and Authorithy","query":"fetch logs //, scanLimitGBytes: 500, samplingRatio: 1000\n| filter matchesValue(k8s.namespace.name, \"hipster-shop\") \n| filter contains(content,\"ACCES\")\n| parse content ,\"LD:intro DQS:downstream LD SPACE DQS:dowstrealtls SPACE DQS LD SPACE DQS:method SPACE DQS LD SPACE DQS:path SPACE DQS LD SPACE DQS:protocol SPACE DQS LD SPACE DQS:Connection SPACE DQS LD SPACE DQS:response_code SPACE DQS LD SPACE DQS:response_flags SPACE DQS LD SPACE DQS:response_code_detaiuls SPACE DQS LD SPACE DQS:traceid SPACE DQS LD SPACE DQS:upstream_service_time SPACE DQS LD SPACE DQS:upstream_local_adress SPACE DQS LD SPACE DQS:duration SPACE DQS LD SPACE DQS:upstreamfailurereason SPACE DQS LD SPACE DQS:routename SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:useragent SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:request_servername SPACE DQS LD SPACE DQS:bytereceived SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:bytesent SPACE DQS LD SPACE DQS:upstreamcluster SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:authority LD \"\n| filter response_code_detaiuls ==\"via_upstream\"\n| filter contains(upstreamcluster,\"outbound\")\n| summarize avg(toDuration(duration)), by:{bin(timestamp, 30s),k8s.deployment.name, authority}","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"categoryOverrides":{}},"singleValue":{"label":"","prefixIcon":"","autoscale":true,"alignment":"center"},"table":{"rowDensity":"condensed","enableLineWrap":true,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}}}},"7":{"type":"data","title":"Number of request/min rejected ( circuit breaker)","query":"fetch logs //, scanLimitGBytes: 500, samplingRatio: 1000\n| filter matchesValue(k8s.namespace.name, \"hipster-shop\") \n| filter contains(content,\"ACCES\")\n| parse content ,\"LD:intro DQS:downstream LD SPACE DQS:dowstrealtls SPACE DQS LD SPACE DQS:method SPACE DQS LD SPACE DQS:path SPACE DQS LD SPACE DQS:protocol SPACE DQS LD SPACE DQS:Connection SPACE DQS LD SPACE DQS:response_code SPACE DQS LD SPACE DQS:response_flags SPACE DQS LD SPACE DQS:response_code_detaiuls SPACE DQS LD SPACE DQS:traceid SPACE DQS LD SPACE DQS:upstream_service_time SPACE DQS LD SPACE DQS:upstream_local_adress SPACE DQS LD SPACE DQS:duration SPACE DQS LD SPACE DQS:upstreamfailurereason SPACE DQS LD SPACE DQS:routename SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:useragent SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:request_servername SPACE DQS LD SPACE DQS:bytereceived SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:bytesent SPACE DQS LD SPACE DQS:upstreamcluster SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:authority LD \"\n| filter response_code_detaiuls == \"upstream_reset_before_response_started{remote_connection_failure,delayed_connect_error:_111}\"\n| summarize count() , by: {bin(timestamp, 30s),k8s.deployment.name}","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"categoryOverrides":{}},"singleValue":{"label":"","prefixIcon":"","autoscale":true,"alignment":"center"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}}}},"8":{"type":"data","title":"Number of request/min overflow( circuit breaker)","query":"fetch logs //, scanLimitGBytes: 500, samplingRatio: 1000\n| filter matchesValue(k8s.namespace.name, \"hipster-shop\") \n| filter contains(content,\"ACCES\")\n| parse content ,\"LD:intro DQS:downstream LD SPACE DQS:dowstrealtls SPACE DQS LD SPACE DQS:method SPACE DQS LD SPACE DQS:path SPACE DQS LD SPACE DQS:protocol SPACE DQS LD SPACE DQS:Connection SPACE DQS LD SPACE DQS:response_code SPACE DQS LD SPACE DQS:response_flags SPACE DQS LD SPACE DQS:response_code_detaiuls SPACE DQS LD SPACE DQS:traceid SPACE DQS LD SPACE DQS:upstream_service_time SPACE DQS LD SPACE DQS:upstream_local_adress SPACE DQS LD SPACE DQS:duration SPACE DQS LD SPACE DQS:upstreamfailurereason SPACE DQS LD SPACE DQS:routename SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:useragent SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:request_servername SPACE DQS LD SPACE DQS:bytereceived SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:bytesent SPACE DQS LD SPACE DQS:upstreamcluster SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:authority LD \"\n| filter response_code_detaiuls == \"upstream_reset_before_response_started{overflow}\"\n| summarize count() , by: {bin(timestamp, 30s),k8s.deployment.name}","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"categoryOverrides":{}},"singleValue":{"label":"","prefixIcon":"","autoscale":true,"alignment":"center"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}}}},"9":{"type":"data","title":"Number of request/min no healthy( circuit breaker)","query":"fetch logs //, scanLimitGBytes: 500, samplingRatio: 1000\n| filter matchesValue(k8s.namespace.name, \"hipster-shop\") \n| filter contains(content,\"ACCES\")\n| parse content ,\"LD:intro DQS:downstream LD SPACE DQS:dowstrealtls SPACE DQS LD SPACE DQS:method SPACE DQS LD SPACE DQS:path SPACE DQS LD SPACE DQS:protocol SPACE DQS LD SPACE DQS:Connection SPACE DQS LD SPACE DQS:response_code SPACE DQS LD SPACE DQS:response_flags SPACE DQS LD SPACE DQS:response_code_detaiuls SPACE DQS LD SPACE DQS:traceid SPACE DQS LD SPACE DQS:upstream_service_time SPACE DQS LD SPACE DQS:upstream_local_adress SPACE DQS LD SPACE DQS:duration SPACE DQS LD SPACE DQS:upstreamfailurereason SPACE DQS LD SPACE DQS:routename SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:useragent SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:request_servername SPACE DQS LD SPACE DQS:bytereceived SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:bytesent SPACE DQS LD SPACE DQS:upstreamcluster SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:authority LD \"\n| filter response_code_detaiuls == \"no_healthy_upstream\"\n| summarize count() , by: {bin(timestamp, 30s),k8s.deployment.name}","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"categoryOverrides":{}},"singleValue":{"label":"","prefixIcon":"","autoscale":true,"alignment":"center"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}}}},"10":{"type":"markdown","title":"","content":"**Latency of the Envoy**"},"11":{"type":"markdown","title":"","content":"**Behaviour of the dataplane**"},"12":{"type":"markdown","title":"","content":"**CPU usage of the envoy proxy**"},"13":{"type":"data","title":"number of request coming in per workload and version","query":"fetch logs //, scanLimitGBytes: 500, samplingRatio: 1000\n| filter matchesValue(k8s.namespace.name, \"hipster-shop\") \n| filter contains(content,\"ACCES\")\n| parse content ,\"LD:intro DQS:downstream LD SPACE DQS:dowstrealtls SPACE DQS LD SPACE DQS:method SPACE DQS LD SPACE DQS:path SPACE DQS LD SPACE DQS:protocol SPACE DQS LD SPACE DQS:Connection SPACE DQS LD SPACE DQS:response_code SPACE DQS LD SPACE DQS:response_flags SPACE DQS LD SPACE DQS:response_code_detaiuls SPACE DQS LD SPACE DQS:traceid SPACE DQS LD SPACE DQS:upstream_service_time SPACE DQS LD SPACE DQS:upstream_local_adress SPACE DQS LD SPACE DQS:duration SPACE DQS LD SPACE DQS:upstreamfailurereason SPACE DQS LD SPACE DQS:routename SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:useragent SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:request_servername SPACE DQS LD SPACE DQS:bytereceived SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:bytesent SPACE DQS LD SPACE DQS:upstreamcluster SPACE DQS LD SPACE DQS SPACE DQS LD SPACE DQS:authority LD \"\n| filter response_code_detaiuls == \"via_upstream\"\n| lookup [fetch dt.entity.cloud_application] , sourceField:dt.entity.cloud_application, lookupField:id, fields:{entity.name,cloudApplicationLabels}\n| fieldsAdd version= cloudApplicationLabels[`app.kubernetes.io/version`]\n| fieldsRemove cloudApplicationLabels\n\n| filter request_servername != \"-\"\n| summarize count() , by:{bin(timestamp, 30s),entity.name,version}","visualization":"lineChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"absolute"},"categoryOverrides":{}},"singleValue":{"label":"","prefixIcon":"","autoscale":true,"alignment":"center"},"table":{"rowDensity":"condensed","enableLineWrap":true,"enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}}}}},"layouts":{"0":{"x":0,"y":8,"w":9,"h":6},"1":{"x":9,"y":8,"w":8,"h":6},"2":{"x":0,"y":27,"w":23,"h":6},"4":{"x":0,"y":1,"w":24,"h":6},"5":{"x":0,"y":33,"w":23,"h":6},"7":{"x":17,"y":8,"w":7,"h":6},"8":{"x":0,"y":14,"w":12,"h":6},"9":{"x":12,"y":14,"w":12,"h":6},"10":{"x":0,"y":26,"w":22,"h":1},"11":{"x":0,"y":7,"w":24,"h":1},"12":{"x":0,"y":0,"w":23,"h":1},"13":{"x":0,"y":20,"w":24,"h":6}}}